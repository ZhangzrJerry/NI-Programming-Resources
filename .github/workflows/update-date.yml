name: Update Last Commit Date

on:
  push:
    branches: [ main, master ]

jobs:
  update-date:
    runs-on: ubuntu-latest
    permissions:
      contents: write 
    steps:
    - uses: actions/checkout@v4
      with:
        fetch-depth: 0
    
    - name: Update README with last commit date
      run: |
        LAST_COMMIT_DATE=$(git log -1 --format=%cd --date=format:%Y.%-m.%-d)
        sed -i "s/Date-.*-blue/Date-${LAST_COMMIT_DATE}-blue/g" README.md
    
    - name: Commit and push if changed
      run: |
        git config --global user.name 'GitHub Actions'
        git config --global user.email 'actions@github.com'
        git add README.md
        git diff --quiet && git diff --staged --quiet || git commit -m "docs: update last commit date"
        git push
